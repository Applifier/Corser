#!/usr/bin/env node
var argv, http, corser, server;

argv = require("optimist").default("port", 1337).alias("p", "port").argv;
http = require("http");
corser = require("../lib/corser");
proxer = require("../lib/proxer");

server = http.createServer(function (req, res) {
    var corserRequestListener;
    corserRequestListener = corser.create();
    corserRequestListener(req, res, function () {
        var proxerRequestListener;
        proxerRequestListener = proxer.create();
        proxerRequestListener(req, res);
    });
});
server.listen(argv.port);
console.log("Corser running on port " + argv.port + ".");

// vim: ft=javascript
